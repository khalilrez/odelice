<%- include('head.ejs') %>

    <body class="sub_page">
        <%- include('navbar.ejs') %>
        <section class="cart_section layout_padding">
            <div class="container">
                <div class="heading_container heading_center">
    
                <!-- Your order form goes here, you can use the menuItem details -->
                <h2>Cht7eb fih?</h2>
                <form method="post" onsubmit="return false;">
                    <!-- Include hidden input fields to pass menuItem details -->
                    <input type="hidden" name="itemName" value="<%= menuItem.itemName %>">
                    <input type="hidden" name="itemId" value="<%= menuItem.itemId %>">
                    <input type="hidden" name="description" value="<%= menuItem.description %>">
                    <input type="hidden" name="price" value="<%= menuItem.price %>">
                    <input type="hidden" name="image" value="<%= menuItem.image %>">

                    <!-- Add more input fields for additional order specifications -->
                    <!-- Boutons radio pour le type de pain -->
                    <label for="breadType">Type de Pain :</label>
                    <input type="radio" name="breadType" value="white" checked> Blanc
                    <input type="radio" name="breadType" value="wholegrain"> Complet
                    <br>

                    <!-- Cases à cocher pour la Garniture -->
                    <label for="garniture">Garniture :</label>
                    <input type="checkbox" name="garniture" value="lettuce"> Laitue
                    <input type="checkbox" name="garniture" value="tomato"> Tomate
                    <!-- Ajoutez plus d'options de garniture si nécessaire -->
                    <br>

                    <!-- Cases à cocher pour la Sauce -->
                    <label for="sauce">Sauce :</label>
                    <input type="checkbox" name="sauce" value="mayo"> Mayo
                    <input type="checkbox" name="sauce" value="mustard"> Moutarde
                    <!-- Ajoutez plus d'options de sauce si nécessaire -->
                    <br>

                    <!-- Champ pour la Quantité -->
                    <label for="quantity">Quantité :</label>
                    <input type="number" name="quantity">
                    <br>

                    <!-- Cases à cocher pour les Extras -->
                    <label for="extras">Extras :</label>
                    <input type="checkbox" name="extras" value="cheese"> Fromage
                    <input type="checkbox" name="extras" value="bacon"> Bacon
                    <!-- Ajoutez plus d'options d'extras si nécessaire -->
                    <br>

                    <!-- Zone de texte pour les Notes -->
                    <label for="notes">Notes :</label>
                    <textarea name="notes" rows="4" cols="50"></textarea>
                    <br>

                    <button type="button" class="btn btn-secondary" onclick="submitOrder()">Ajouter au panier</button>
                </form>
            </div>
            </div>
            </section>
            <!-- Add this script in your EJS file -->
            <script>
                function submitOrder() {
                    // Get values from form fields
                    const breadType = document.querySelector('input[name="breadType"]:checked').value;
                    const garniture = Array.from(document.querySelectorAll('input[name="garniture"]:checked')).map(checkbox => checkbox.value);
                    const sauce = Array.from(document.querySelectorAll('input[name="sauce"]:checked')).map(checkbox => checkbox.value);
                    const quantity = document.querySelector('input[name="quantity"]').value;
                    const extras = Array.from(document.querySelectorAll('input[name="extras"]:checked')).map(checkbox => checkbox.value);
                    const notes = document.querySelector('textarea[name="notes"]').value;
                    const itemName = document.querySelector('input[name="itemName"]').value;
                    const itemId = document.querySelector('input[name="itemId"]').value;
                    const itemPrice = document.querySelector('input[name="price"]').value;




                    // Concatenate notes
                    const concatenatedNotes = `Pain: ${breadType}\nGarniture: ${garniture.join(', ')}\nSauce: ${sauce.join(', ')}\nQuantité: ${quantity}\nExtras: ${extras.join(', ')}\nNotes: ${notes}`;

                    // Create orderItem object
                    const orderItem = {
                        itemId: itemId, // Add the actual value from your data
                        itemName: itemName,
                        price: itemPrice,
                        notes: concatenatedNotes,
                    };

                    // Retrieve existing cart from localStorage or create an empty array
                    const cart = JSON.parse(localStorage.getItem('cart')) || [];

                    // Add the current orderItem to the cart
                    cart.push(orderItem);

                    // Save the updated cart back to localStorage
                    localStorage.setItem('cart', JSON.stringify(cart));

                    // Log or send the orderItem as needed
                    console.log(orderItem);
                    alert("Ajouté au panier")
                    window.location.href = '/menu'
                }
            </script>

            <%- include('foot.ejs') %>